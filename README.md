# 비디오 스트리밍 HLS (애플 프로토콜)

/video/한글.m3u8

```text
1. 서버측에서 동영상 인코딩
2. 프론트측에서 동영상 인코딩 비동기로 해서 올리기
3. 스트리밍해서 보기
```

```text
3가지 방법
1. 서버측 동영상 업로드 and 비동기로 hls 변환
2. 서버측 동영상 업로드 후 - 스트리밍 요청시 hls 변환 후 전달
3. 프론트 단에서 동영상 업로드시에 hls 변환 후 서버 전달
```

```text
단점
서버 부하 증가: 모든 인코딩 작업이 서버에서 처리되므로, 서버의 부하가 증가할 수 있습니다.
확장성 문제: 많은 사용자가 동시에 인코딩을 요청하면 서버의 부하가 급격히 증가할 수 있으며, 이를 처리하기 위해 서버 리소스를 확장해야 할 수 있습니다.
응답 지연: 인코딩 작업이 완료될 때까지 사용자가 대기해야 할 수 있습니다.
클라이언트 측 인코딩
장점
서버 부하 감소: 인코딩 작업을 클라이언트에서 처리하므로, 서버의 부하가 줄어듭니다.
확장성 용이: 클라이언트가 인코딩 작업을 수행하므로, 서버의 확장성 문제를 해결할 수 있습니다.
실시간 반응성: 클라이언트 측에서 인코딩과 동시에 미리보기 기능을 제공할 수 있습니다.
```
1. .m3u8 파일
   .m3u8 파일은 HLS 플레이리스트 파일입니다. 이 파일은 스트림의 메타데이터를 포함하고 있으며, 플레이어가 재생할 미디어 세그먼트(.ts 파일)의 목록을 제공합니다. .m3u8 파일은 다음과 같은 정보를 포함할 수 있습니다:

미디어 세그먼트의 URI
각 세그먼트의 길이
스트림의 버전
스트림의 타겟 지속 시간
추가적인 메타데이터
예시
m3u8
코드 복사
#EXTM3U
#EXT-X-VERSION:3
#EXT-X-TARGETDURATION:10
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:10.0,
test0.ts
#EXTINF:10.0,
test1.ts
#EXTINF:10.0,
test2.ts
#EXT-X-ENDLIST
2. .ts 파일
   .ts 파일은 실제 미디어 데이터를 포함하는 MPEG-TS(Transport Stream) 파일입니다. 이 파일들은 비디오, 오디오 및 자막 데이터를 포함할 수 있으며, .m3u8 플레이리스트 파일에 의해 참조됩니다. HLS 플레이어는 .m3u8 파일을 읽고, 그에 따라 .ts 파일을 순차적으로 다운로드하여 재생합니다.

예시
test0.ts, test1.ts, test2.ts 파일들은 각각 10초 길이의 비디오 세그먼트를 포함하고 있습니다.

HLS 재생 과정
플레이리스트 다운로드: HLS 플레이어는 .m3u8 파일을 다운로드합니다.
세그먼트 다운로드: 플레이리스트에 나열된 .ts 파일을 순차적으로 다운로드합니다.
비디오 재생: 다운로드된 .ts 파일을 재생하여 스트리밍 비디오를 시청합니다.
코드에서의 역할

```text

넷플릭스와 같은 스트리밍 서비스는 일반적으로 사용자가 특정 시간으로 점프할 때 필요한 TS 파일만 다운로드하는 방식으로 동작합니다. 즉, 사용자가 12분으로 점프하면 12분에 해당하는 TS 파일과 그 이후의 파일들만 다운로드하여 재생을 시작합니다. 이는 효율적이고 빠른 재생을 위해 필요한 방식입니다.

당신이 제공한 조건을 바탕으로 설명드리면:

총 15분 동영상
TS 파일은 60초 단위로 분할되어 총 15개 (0번 ~ 14번)
최초 재생 시 0번, 1번, 2번 TS 파일을 다운로드
만약 사용자가 12분으로 점프한다면:

12분은 720초이므로, 60초 단위 TS 파일에서 12분은 11번 TS 파일에 해당
따라서, 11번, 12번, 13번 TS 파일을 다운로드
이와 같이 작동함으로써 네트워크 대역폭을 효율적으로 사용하고, 사용자 경험을 개선할 수 있습니다.

아래는 이러한 동작 방식을 구현하는 예제입니다:
```